<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Kadie AI â€¢ Bot Options</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <link rel="stylesheet" href="/assets/main.css" />
  <style>
    .toolbar{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:10px}
    .toolbar .group{display:flex;gap:8px;align-items:center}
    .select,.btn{border:1px solid #0003;background:#111;color:#eee;padding:6px 8px;border-radius:8px}
    .btn{cursor:pointer}
    .btn[disabled]{opacity:.5;cursor:not-allowed}

    /* Left variables bar + editor layout */
    .editor-layout{display:grid;grid-template-columns:300px 1fr;gap:12px;align-items:stretch}
    .leftdock{
      min-height:68vh; min-width:300px; background:#0b0c0f; border:1px solid #0004; border-radius:12px;
      padding:10px; overflow:auto;
    }
    .leftdock .section-title{font-size:12px;color:#9aa3af;margin:8px 0 6px 0;text-transform:uppercase;letter-spacing:.06em}
    .leftdock .search{position:sticky;top:0;background:#0b0c0f;padding-bottom:8px;z-index:1}
    .leftdock input[type="search"]{
      width:100%; box-sizing:border-box; border:1px solid #2b2f3a; background:#11131a; color:#eaeaea;
      padding:6px 8px; border-radius:8px; outline:none;
    }
    .leftdock .list{display:flex;flex-direction:column;gap:4px}
    .leftdock .item{
      display:flex;align-items:center;gap:8px;padding:6px 8px;border:1px solid #1e2230;border-radius:8px;
      background:#11131a;color:#e5e7eb;font-size:13px;cursor:grab;
    }
    .leftdock .item.dragging{opacity:.6}
    .leftdock .pill{font-size:10px;padding:2px 6px;border-radius:999px;background:#182032;border:1px solid #2a3550;color:#93c5fd}
    .leftdock .group-title{margin-top:6px;margin-bottom:4px;color:#a3a3a3;font-weight:600;font-size:12px}
    .leftdock .divider{height:1px;background:#1a1f2a;margin:10px 0}
    .copy-hint{font-size:11px;color:#9aa3af;margin:6px 0 0 0}

    .editor-wrap{position:relative;height:68vh;min-height:420px;border:1px solid #0004;border-radius:12px;overflow:hidden;background:#0b0b0c}
    .grid{position:absolute;inset:0;background:
      linear-gradient(#1a1a1a 1px, transparent 1px),
      linear-gradient(90deg,#1a1a1a 1px, transparent 1px);
      background-size:24px 24px,24px 24px}
    .nodes{position:absolute;inset:0}
    .node{position:absolute;min-width:180px;background:#17181b;color:#eaeaea;border:1px solid #3a3d47;border-radius:10px;box-shadow:0 6px 18px #0006;user-select:none}
    .node .header{padding:6px 8px;font-weight:600;background:#1e2026;border-bottom:1px solid #2b2f3a;border-top-left-radius:10px;border-top-right-radius:10px;display:flex;justify-content:space-between}
    .pins{display:grid;grid-template-columns:1fr 1fr;gap:6px;padding:8px}
    .pin{display:flex;align-items:center;gap:6px;font-size:12px}
    .pin.exec .jack{background:#6cf}
    .pin.data .jack{background:#a6f08a}
    .jack{width:10px;height:10px;border-radius:50%;border:2px solid #0008;box-sizing:content-box}
    .pin.left{justify-content:flex-start}
    .pin.right{justify-content:flex-end;flex-direction:row-reverse}
    .selected{outline:2px solid #5ac8fa}
    .disabled-overlay{position:absolute;inset:0;background:#000000aa;display:flex;align-items:center;justify-content:center;color:#aaa;font-weight:600;font-size:14px;z-index:50}
    .context{position:absolute;background:#121317;border:1px solid #2e3342;border-radius:8px;box-shadow:0 10px 24px #000a;padding:6px;min-width:260px;z-index:60;max-height:60vh;overflow:auto}
    .context h4{margin:6px 8px;font-size:12px;color:#98a2b3}
    .menu-item{padding:8px 10px;font-size:13px;color:#e3e7ee;cursor:grab}
    .menu-item:hover{background:#1f2330}
    .submenu{margin-left:6px;padding-left:6px;border-left:1px dashed #2b3040}
    .statusbar{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-top:10px}
    .dirty{display:none}
    .dirty.show{display:flex;gap:8px;align-items:center}
    .hint{font-size:12px;color:#96a0ad}
    svg.wires{position:absolute;inset:0;pointer-events:none}
    path.wire{fill:none;stroke:#7dd3fc;stroke-width:3px;filter:drop-shadow(0 0 4px #7dd3fcaa)}
    path.wire.data{stroke:#a7f3d0;filter:drop-shadow(0 0 4px #a7f3d0aa)}
    .rubber{position:absolute;border:1px dashed #5ac8fa;background:#5ac8fa22;display:none;z-index:55}
  </style>
</head>
<body>
  <header class="container"><h1>Kadie AI</h1></header>

  <main class="container">
    <div class="card" style="margin-bottom:14px;">
      <div style="display:flex;gap:12px;align-items:center;">
        <img id="gicon" alt="" width="64" height="64" style="border-radius:12px;background:#0002;object-fit:cover;">
        <div>
          <h2 id="gname" style="margin:0 0 4px 0;font-size:20px;">Server</h2>
          <div class="small" id="gmeta"></div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="toolbar">
        <div class="group">
          <label for="bpSelect" class="hint">Blueprint</label>
          <select id="bpSelect" class="select" style="min-width:260px"></select>
          <button id="bpCreate" class="btn">Create</button>
          <button id="bpRename" class="btn">Rename</button>
          <button id="bpDelete" class="btn" style="color:#fda4af;border-color:#7f1d1d">Delete</button>
        </div>
        <div class="group">
          <button id="undoBtn" class="btn">Undo</button>
          <button id="redoBtn" class="btn">Redo</button>
        </div>
      </div>

      <div class="editor-layout">
        <!-- Left variables bar -->
        <aside class="leftdock" id="leftdock">
          <div class="search">
            <input id="leftdockSearch" type="search" placeholder="Search channels or roles" autocomplete="off">
            <p class="copy-hint">Click copies ID. Drag to graph.</p>
          </div>

          <div class="section-title">Channels</div>
          <div id="channelsList" class="list" aria-label="Channels"></div>

          <div class="divider"></div>

          <div class="section-title">Roles</div>
          <div id="rolesList" class="list" aria-label="Roles"></div>
        </aside>

        <!-- Graph editor -->
        <div class="editor-wrap" id="editor">
          <div class="grid"></div>
          <svg class="wires" id="wires" viewBox="0 0 1000 1000" preserveAspectRatio="none"></svg>
          <div class="nodes" id="nodes"></div>
          <div class="disabled-overlay" id="disabledOverlay">Select or create a blueprint to edit</div>
          <div class="context" id="ctx" style="display:none"></div>
          <div class="rubber" id="rubber"></div>
        </div>
      </div>

      <div class="statusbar">
        <div class="dirty" id="dirty">
          <span class="hint">Unsaved changes</span>
          <button class="btn" id="saveBtn">Save</button>
          <button class="btn" id="revertBtn">Revert</button>
        </div>
        <div class="hint">Right-click for nodes. Drag to move. Connect pins.</div>
      </div>
    </div>
  </main>

  <script type="module" src="/kadie-ai/bot-options.js?v=2"></script>
</body>
</html>
